# Expense Tracker — pet‑проект на Go

Expense Tracker — учебный проект, реализующий минимальный REST API для учёта расходов. Сервис написан на Go, использует Gorilla Mux для маршрутизации и хранит данные в локальном JSON‑файле. Проект предназначен для закрепления базовых практик разработки REST API, разделения кода по слоям, валидации входящих данных и обработки ошибок.

---
## Назначение и функциональность

Сервис предоставляет следующие возможности:

* создание расхода;
* обновление расхода по идентификатору;
* удаление расхода по идентификатору;
* получение списка всех расходов;
* получение общей суммы расходов;
* получение суммы расходов за выбранный месяц.

Данные сохраняются в JSON‑файл. При старте приложения файл загружается в память, после чего любые изменения синхронно записываются обратно.

---

## Структура проекта

Проект разделён на два пакета.

### expense/

Содержит доменную модель и логику хранения:

* `Expense` — модель расхода (ID, описание, дата, сумма);
* набор доменных ошибок (например, некорректные данные или отсутствие записи);
* `Storage` — файловое хранилище на JSON‑файле, включающее:

  * загрузку данных при старте;
  * хранение расходов в памяти в map;
  * CRUD‑операции;
  * расчёт сводных значений (общая сумма и сумма по месяцу);
  * потокобезопасность через `sync.Mutex`;
  * сохранение данных через временный файл (atomic write).

### http/

Содержит транспортный слой:

* DTO для запросов и ответов;
* валидацию входящих данных (описание, сумма, формат даты `YYYY‑MM‑DD`);
* HTTP‑хендлеры;
* настройку роутов и запуск HTTP‑сервера через Gorilla Mux.

Такое разделение отделяет доменную/хранилищную часть от HTTP‑интерфейса.

---

## Реализованные эндпоинты

### Операции с расходами

* `POST /expenses` — создать расход.
* `PATCH /expenses/{id}` — обновить расход по ID.
* `DELETE /expenses/{id}` — удалить расход по ID.
* `GET /expenses` — получить список всех расходов.

### Сводные данные

* `GET /expenses/summary` — общая сумма всех расходов.
* `GET /expenses/summary?month={month}` — сумма расходов за указанный месяц.

---

Пример запроса:

```bash
curl -X POST http://localhost:8080/expenses \
  -H "Content-Type: application/json" \
  -d '{"description":"coffee","date":"2025-11-22","amount":3.5}'
```

---
